<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <link rel="stylesheet" href="OpenLayers/theme/default/style.css" type="text/css"/>
    <script src="OpenLayers/OpenLayers.js"></script>
    <script type="text/javascript">
        function init(){
          var loc = window.location + ""
          if(loc.lastIndexOf("/") != loc.length - 1) loc = loc.substring(0, loc.lastIndexOf("/") + 1)

            var lon = 1086180;
            var lat = 6559837;
            var zoom = 6;
          
          
          var map = new OpenLayers.Map( 'map', {
            projection: new OpenLayers.Projection("EPSG:900913"),
            numZoomLevels: 15,            
            units: "m",
            maxResolution: 156543.0339,
            maxExtent: new OpenLayers.Bounds(-1381981, 5150021, 4635141, 7872402),
            allOverlays: true
          } )

          var osmLayer = new OpenLayers.Layer.OSM("OpenStreetMap");
          map.addLayer(osmLayer)
          
          var layer1 = new OpenLayers.Layer.WMS( 'ALKIS all', loc + "../../services", {layers: 'TatsaechlicheNutzung,Relief,BauwerkeEinrichtungenUndSonstigeAngaben,GesetzlicheFestlegungenGebietseinheitenKataloge,AngabenzumGebaeude,FlurstueckeLagePunkt,Beschriftung', transparent: true}, {singleTile: true});
          map.addLayer(layer1);
          var layer2 = new OpenLayers.Layer.WMS( 'Tats. Nutzung', loc + "../../services", {layers: 'TatsaechlicheNutzung', transparent: true}, {singleTile: false, visibility: false});
          map.addLayer(layer2);
          var layer3 = new OpenLayers.Layer.WMS( 'Relief', loc + "../../services", {layers: 'Relief', transparent: true}, {singleTile: true, visibility: false});
          map.addLayer(layer3);
          var layer4 = new OpenLayers.Layer.WMS( 'Bauw. Einr. Sonst. An.', loc + "../../services", {layers: 'BauwerkeEinrichtungenUndSonstigeAngaben', transparent: true}, {singleTile: true, visibility: false});
          map.addLayer(layer4);
          var layer5 = new OpenLayers.Layer.WMS( 'Ges. Festl. Geb. Einh. Kata.', loc + "../../services", {layers: 'GesetzlicheFestlegungenGebietseinheitenKataloge', transparent: true}, {singleTile: true, visibility: false});
          map.addLayer(layer5);
          var layer6 = new OpenLayers.Layer.WMS( 'Angaben zum Gebaeude', loc + "../../services", {layers: 'AngabenzumGebaeude', transparent: true}, {singleTile: true, visibility: false});
          map.addLayer(layer6);
          var layer7 = new OpenLayers.Layer.WMS( 'Flurstuecke Lage Punkt', loc + "../../services", {layers: 'FlurstueckeLagePunkt', transparent: true}, {singleTile: true, visibility: false});
          map.addLayer(layer7);
          var layer8 = new OpenLayers.Layer.WMS( 'Beschriftung', loc + "../../services", {layers: 'Beschriftung', transparent: true}, {singleTile: true, visibility: false});
          map.addLayer(layer8);
          /*
          var req = new XMLHttpRequest()

          req.open("GET", loc + "../../services?request=GetCapabilities&service=WMS&version=1.1.1", false)
          req.send(null)
          var res = req.responseXML

          res = res.evaluate('//Layer/Name', res.documentElement, null, 0, null)
          var next = res.iterateNext()
          while(next){
            var layer = new OpenLayers.Layer.WMS( next.nodeValue, loc + "../../services", {layers: next.textContent, transparent: true}, {singleTile: true})
            layer.setName(next.textContent)
            layer.setVisibility(false)
            map.addLayer(layer)
            next = res.iterateNext()
          }
          */
          map.setCenter(new OpenLayers.LonLat(lon, lat), zoom)
          map.addControl(new OpenLayers.Control.LayerSwitcher())
          
        }
        
    </script>
  </head>
  <body onload="init()">
    <h1 id="title">deegree ALKIS WMS Demonstrator</h1>
    <div id="tags">
    </div>
    <p id="shortdesc">
    </p>
    <div id="map" class="largemap"/>
  </body>
</html>
