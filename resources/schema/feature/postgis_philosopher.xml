<?xml version="1.0" encoding="UTF-8"?>
<ApplicationSchema
    xmlns="http://www.deegree.org/feature/featuretype"
    xmlns:app="http://www.deegree.org/app"
    xmlns:gml="http://www.opengis.net/gml"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.deegree.org/feature/featuretype ./0.3.0/postgis_appschema.xsd">

  <!-- Global mapping information -->
  <Mapping>
    <!-- Identifier of the JDBC connection. -->
    <JDBCConnId>conn1</JDBCConnId>
    <!--
      If true, table "OBJECT_LOOKUP" is used for keeping track of all
      features/geometries and their ids. If false, the following restrictions apply: 
      - all GML-Ids must match format: PREFIX_INTEGER, usage of USE_EXISTING/REPLACE_DUPLICATE id
        generation is restricted
      - Not usable for application schemas that use feature properties containing abstract feature types 
    -->
    <UseObjectLookupTable>true</UseObjectLookupTable>
  </Mapping>

  <!-- Feature type {http://www.deegree.org/app}Philosopher -->
  <FeatureType name="app:Philosopher">
    <Mapping>
      <DBTable>PHILOSOPHER</DBTable>
      <GMLDefaultProps>true</GMLDefaultProps>
    </Mapping>
    <SimpleProperty name="id" type="integer">
      <Mapping>
        <DBColumn name="ID" sqlType="INTEGER"/>
      </Mapping>
    </SimpleProperty>
    <SimpleProperty name="name" type="string">
      <Mapping>
        <DBColumn name="NAME" sqlType="VARCHAR(100)" />
      </Mapping>
    </SimpleProperty>
    <SimpleProperty name="sex" type="string">
      <Mapping>
        <DBColumn name="NAME" sqlType="CHAR(1)" />
      </Mapping>
    </SimpleProperty>
    <SimpleProperty name="subject" type="string" minOccurs="0" maxOccurs="unbounded">
      <Mapping>
        <PropertyTable table="SUBJECT" column="NAME" sqlType="VARCHAR(100)"/>
      </Mapping>
    </SimpleProperty>
    <FeatureProperty name="isAuthorOf" type="app:Book" minOccurs="0" maxOccurs="unbounded">
      <Mapping>
        <FeatureJoinTable table="IS_AUTHOR_OF"/>
      </Mapping>
    </FeatureProperty>
    <SimpleProperty name="dateOfBirth" type="date">
      <Mapping>
        <DBColumn name="DATE_OF_BIRTH" sqlType="DATE" />
      </Mapping>
    </SimpleProperty>
    <FeatureProperty name="placeOfBirth" type="app:Place">
      <Mapping>
        <DBColumn name="PLACE_OF_BIRTH"/>
      </Mapping>
    </FeatureProperty>
    <SimpleProperty name="dateOfDeath" type="date">
      <Mapping>
        <DBColumn name="DATE_OF_DEATH" sqlType="DATE" />
      </Mapping>
    </SimpleProperty>
    <FeatureProperty name="placeOfDeath" type="app:Place">
      <Mapping>
        <DBColumn name="PLACE_OF_DEATH"/>
      </Mapping>
    </FeatureProperty>
    <FeatureProperty name="friend" type="app:Philosopher" maxOccurs="unbounded">
      <Mapping>
        <FeatureJoinTable table="IS_FRIENDS_WITH"/>
      </Mapping>
    </FeatureProperty>
  </FeatureType>

  <!-- Feature type {http://www.deegree.org/app}Book -->
  <FeatureType name="Book">
    <Mapping>
      <DBTable>BOOK</DBTable>
      <GMLDefaultProps>true</GMLDefaultProps>
    </Mapping>  
    <SimpleProperty name="title" type="string">
      <Mapping>
        <DBColumn name="TITLE" sqlType="VARCHAR(200)" />
      </Mapping>
    </SimpleProperty>
    <SimpleProperty name="publicationDate" type="date">
      <Mapping>
        <DBColumn name="PUB_DATE" sqlType="DATE" />
      </Mapping>
    </SimpleProperty>
  </FeatureType>

  <!-- Feature type {http://www.deegree.org/app}Place -->
  <FeatureType name="Place">
    <Mapping>
      <DBTable>PLACE</DBTable>
      <GMLDefaultProps>true</GMLDefaultProps>   
    </Mapping>
    <SimpleProperty name="name" type="string">
      <Mapping>
        <DBColumn name="NAME" sqlType="VARCHAR(100)" />
      </Mapping>    
    </SimpleProperty>
    <FeatureProperty name="country" type="Country">
      <Mapping>
        <DBColumn name="COUNTRY_ID" sqlType="INTEGER" />
      </Mapping>
    </FeatureProperty>
  </FeatureType>

  <!-- Feature type {http://www.deegree.org/app}Country -->
  <FeatureType name="Country">
    <Mapping>
      <DBTable>COUNTRY</DBTable>
      <GMLDefaultProps>true</GMLDefaultProps>
    </Mapping>
    <SimpleProperty name="name" type="string">
      <Mapping>
        <DBColumn name="NAME" sqlType="VARCHAR(100)" />
      </Mapping>
    </SimpleProperty>
    <GeometryProperty name="geom" type="MultiSurface" coordinateDimension="2D">
      <Mapping>
        <GeometryDBColumn name="NAME" sqlType="MULTIPOLYON" dimension="2" srid="4326"/>
      </Mapping>
    </GeometryProperty>
  </FeatureType>
 
</ApplicationSchema>